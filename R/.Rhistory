?pbinom
d[1:exp_results, sum(p)]
d[exp_results:Inf, sum(p)]
d[exp_results:.N, sum(p)]
d[exp_results:.N, sum(p)]
d
dd
d
dd
dd
d
d
p_value
d
d
p_val
x
p_val
p_val
?binom.test
p_val
p_val
d
p_value
p_val
d
d
d
dd
dd
dd
x_obs
dd
x_obs
plot(p_H0)
plot(p_H1)
x
n
x
d
p_vla
p_val
x_obs
n
p_H0
p_val
p_val
x
d
?dbinom
x
density
x
probability
length(x)
pp
x
density
probability
quantile
d
?pbinom
probability
pp
pp
n
p
n
sample
sample
?sample
d
s
min(s)
max(s)
d
x
e
s
d
d
d
dd
dd
d
dd
d
exp_val
d
d <- data.table(n=n_rec, p=p_rec, x=x_rec, p_binom = p_binom_rec)
d
d
d
d
d
0^2
2 + 2
2*2
2^(7-7)
6^(7-7)
6^(7-8)
sqrt(4)
4^(1/2)
d
p
exp_results
p_estimate
exp_results
p_data_given_H0
d
p_value
d
p_value
p
?binom.test
?binom.test
p_val
p_data_given_H0
p_val
d
d
d
e
d
d
dd
p
p
p
p
p
p
p
d
p
p
d
p
n_toal
n_4_notag <- factorial(10) / factorial(10-4)
n_total
n_2_tagged
n_4_tagged
n_4_totag
n_4_notag


p
p
d
d
d
?where
?which
?which
d
d
dd
dd
d
d[, s8 : NULL]
d[, s8 := NULL]
d
dd
  C-c C-c
dd
d
d[, s:=exp_results_1+exp_results_2]
ad
d
ss
d
d
p
d
d
px
Ex
d
Ex
d
d
d
covxy
p
?dgeom
?dgeom
p
exp_results
p = 0.3
?pgeom
?binom.test
?binom.test
?pegeom
?pgeom
pgeom(10, .5)
pgeom(10, .5, lower.tail=F)
?pgeom
d
dd
?pnorm
?pnorm
?pnorm
x
p
?pnorm
d
d
d
d
d
str(d)
x
d
?dnorm
x
x
x
width * height
d
d
d
width
?dnorm
x
fxd
d
d
d[, xs := x <= 0]
d
d[, x[xs]]
d[xs]
d
d[xs]
d[xs==TRUE]
d[x <= 0]
d[, xs := NULL]
d
d
d
d
d
d
d
?pnorm
x_crit
xs
d
d
x_crit
x_crit <- qnorm(alpha, mu, sigma, lower.tail=TRUE)
d
d
d
d
ggplot(data=d, aes(x=x)) +
  geom_line(aes(y=fxd_H0)) +
  geom_vline(xintercept=x_crit, linetype=3) +

d
d
d
d
dd
dd
d
dd
x_crit
n*p_H0
dd
dd
d
d
dd
d
ggplot(data=d) +
  xlab('Number of successes in n Bernoulli trials') +
  ylab('Probability') +
  geom_point(aes(x=x-0.1, y=H0), colour='red') +
  geom_point(aes(x=x+0.1, y=H1), colour='blue') +
  geom_segment(aes(x=x-0.1, xend=x-0.1, y=0, yend=H0), colour='red') +
  geom_segment(aes(x=x+0.1, xend=x+0.1, y=0, yend=H1), colour='blue') +
  geom_segment(x=x_crit, xend=x_crit, y=0, yend=Inf, colour='black', linetype=3) +
  theme(aspect.ratio = 1) +
  annotate('text', x=x_crit, y=0.2, label='x_crit') +

d
d
fxd_B
d
d
d[fxd_B > 0.0]
d[, max(fxd_B)]
?dbinom
an
n
p
mu
sigma
xB
mu
sigma
xN
xB
length(fxdB)
length(fxdB)
length(fxdN)
xN
length(xN)
length(xB)
length(fxdB)
length(fxdN)
d
?dnorm
?dlnorm
?frand
?runif
?runif
x
x
d
x
d
d
dd
dd
dd
dd
d
d
d
d
d
d[, unique(id)]
plot(fxd)
plot(fxp)
rs
d
ds
rs
d
d
d
d
d
d
d
d
x_obs
x_obs
mu
sigma
pH0
x
mu
?t.test
pH0
pH0
?dt
pH0
pH0
pH0
x_obs
mu_H0
pH0
x_obs
sd(x)/n
pH0
z.test
?z.test
?t.test
?z.test
?Z.test
?ztest
pH0
pH0
x_obs
pH0
pH0
x_obs
?pnorm
x_obs
pH0
pH0
?pt
?pt
?pnorm
?pt
x_obs
t_obs
?pt
?pt
pH0
pH0
t_obs
pH0
pH0
t_obs
t_obs/2
pH0
t_obs
n
length(x)
t_obs
pH0
d
melt(d)
melt(d, id.vars="x")
d
z_crit
t_crit
x_obs
pH0
pH0
t_obs
t_obs
pH0
pH0
n
pH0
t_obs
t_obs
pH0
pH0
pH0
pH0
pH0
x_obs
t_obs
pH
pH0
t_oobs
t_obs
rm(list=ls())
pH0
t_obs
a
n
b
x
hist(x)
x_obs
t_obs
t_obs
pH0
x_crit
d
d
ggplot(data=d) +
  xlab('Number of successes in n Bernoulli trials') +
  ylab('Probability') +
  geom_point(aes(x=x-0.1, y=H0)) +
  geom_point(aes(x=x+0.1, y=H1)) +
  geom_line(aes(x=x-0.1, y=H0)) +
  geom_line(aes(x=x+0.1, y=H1)) +
  geom_segment(x=x_crit, xend=x_crit, y=0, yend=Inf, colour='black', linetype=3) +
  geom_segment(x=n*p_H0, xend=n*p_H0, y=0, yend=Inf, colour='black', linetype=3) +
  geom_segment(x=n*p_H1, xend=n*p_H1, y=0, yend=Inf, colour='black', linetype=3) +
  theme(aspect.ratio = 1) +
  geom_ribbon(data=d[x<=x_crit],
              aes(x=x, ymin=0, ymax=H1),
              fill='blue',
              alpha=0.5) +
  geom_ribbon(data=d[x>x_crit],
              aes(x=x, ymin=0, ymax=H1),
              fill='green',
              alpha=0.5) +
  geom_ribbon(data=d[x>x_crit],
              aes(x=x, ymin=0, ymax=H0),
              fill='red',
              alpha=0.5) +
  annotate('text', x=x_crit, y=0.2, label='x_crit', colour='red') +
  annotate('text', x=n*p_H0, y=0.2, label='H0', colour='red') +
  annotate('text', x=n*p_H1, y=0.2, label='H1', colour='red') +
ggplot(data=d) +
  xlab('Number of successes in n Bernoulli trials') +
  ylab('Probability') +
  geom_point(aes(x=x-0.1, y=H0)) +
  geom_point(aes(x=x+0.1, y=H1)) +
  geom_line(aes(x=x-0.1, y=H0)) +
  geom_line(aes(x=x+0.1, y=H1)) +
  geom_segment(x=x_crit, xend=x_crit, y=0, yend=Inf, colour='black', linetype=3) +
  geom_segment(x=n*p_H0, xend=n*p_H0, y=0, yend=Inf, colour='black', linetype=3) +
  geom_segment(x=n*p_H1, xend=n*p_H1, y=0, yend=Inf, colour='black', linetype=3) +
  theme(aspect.ratio = 1) +
  geom_ribbon(data=d[x<=x_crit],
              aes(x=x, ymin=0, ymax=H1),
              fill='blue',
              alpha=0.5) +
  geom_ribbon(data=d[x>x_crit],
              aes(x=x, ymin=0, ymax=H1),
              fill='green',
              alpha=0.5) +
  geom_ribbon(data=d[x>x_crit],
              aes(x=x, ymin=0, ymax=H0),
              fill='red',
              alpha=0.5) +
  annotate('text', x=x_crit, y=0.2, label='x_crit', colour='red') +
  annotate('text', x=n*p_H0, y=0.2, label='H0', colour='red') +
  annotate('text', x=n*p_H1, y=0.2, label='H1', colour='red') +

alpha
lpha
alpha
alpha
lpha
alpha
pwer
power
power
1-beta
d
x_crit
x
hist(x)
sm_rec
hist(sm_rec)
d
pop_mean
a
b
d
pH0
x_obs
pH0
t_obs
d
f
f
d
getwd()
dir_data_delay
f
f
f
f
d
d
str(d)
d
x_crit 
alpha
beta
power
1-beta
d
melt(d, id.var=x)
melt(d, id.var='x')
d
xN
round(xN)
mu
sigma
d
d
d
mu
sigma
x
hist(x)
x_obs
d
